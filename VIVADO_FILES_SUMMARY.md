# Vivado Build: Files to Upload and Use

## ✅ EDIF File Generated Successfully!

**File**: `build/tpu_basys3.edif` (1.4 MB)
- ✅ Generated by Yosys
- ✅ Ready for Vivado import
- ✅ Contains complete synthesized netlist

## Files You Need for Vivado

### Required Files (Minimum):

1. **`build/tpu_basys3.edif`** ⭐
   - **What it is**: Synthesized gate-level netlist
   - **Size**: ~1.4 MB
   - **Generated by**: Yosys
   - **Used by**: Vivado (imports this file)
   - **Location**: `build/tpu_basys3.edif`

2. **`constraints/basys3_nextpnr.xdc`** ⭐
   - **What it is**: Pin locations and IOSTANDARD settings
   - **Size**: ~5 KB
   - **Used by**: Vivado (for pin assignment)
   - **Location**: `constraints/basys3_nextpnr.xdc`

3. **`vivado/build_tpu_vivado.tcl`** ⭐
   - **What it is**: Vivado automation script
   - **Size**: ~2 KB
   - **Used by**: Vivado (runs P&R automatically)
   - **Location**: `vivado/build_tpu_vivado.tcl`

### Optional Files:

- `scripts/build_tpu_bitstream_vivado.sh` - Convenience script (not needed if running Vivado manually)

## How to Use These Files

### Option 1: Automated (Recommended)

```bash
cd /Users/abiralshakya/Documents/tpu_to_fpga
vivado -mode batch -source vivado/build_tpu_vivado.tcl
```

**What happens**:
1. Vivado reads `build/tpu_basys3.edif`
2. Vivado reads `constraints/basys3_nextpnr.xdc`
3. Vivado runs opt_design → place_design → route_design
4. Vivado generates `build/tpu_top_wrapper.bit`

### Option 2: Manual GUI Steps

1. **Open Vivado**:
   ```bash
   vivado &
   ```

2. **Create Project**:
   - File → New Project
   - Name: `tpu_basys3`
   - Type: **RTL Project**
   - Part: `xc7a35tcpg236-1`

3. **Import EDIF**:
   - Sources → Add Sources → Add Files
   - Select: `build/tpu_basys3.edif`
   - Set Top: `tpu_top_wrapper`

4. **Add Constraints**:
   - Constraints → Add Sources → Add Files
   - Select: `constraints/basys3_nextpnr.xdc`

5. **Run Implementation**:
   - Flow Navigator → Generate Bitstream
   - Wait 15-35 minutes

6. **Find Bitstream**:
   - `tpu_basys3.runs/impl_1/tpu_top_wrapper.bit`

## What Gets Uploaded (If Using Remote Machine)

If you're building on a cluster or remote machine, you only need:

**Minimum Package**:
```
vivado_package/
├── tpu_basys3.edif              # From build/tpu_basys3.edif
├── basys3_nextpnr.xdc           # From constraints/basys3_nextpnr.xdc
└── build_tpu_vivado.tcl        # From vivado/build_tpu_vivado.tcl
```

**Upload these 3 files**, then run:
```bash
vivado -mode batch -source build_tpu_vivado.tcl
```

## File Sizes

- `tpu_basys3.edif`: ~1.4 MB (synthesized netlist)
- `basys3_nextpnr.xdc`: ~5 KB (constraints)
- `build_tpu_vivado.tcl`: ~2 KB (script)
- **Total**: ~1.4 MB (very small!)

## What You DON'T Need

❌ **RTL source files** - Already synthesized in EDIF
❌ **Yosys scripts** - Already run
❌ **JSON files** - Only for nextpnr
❌ **Any other files** - Just the 3 files above

## Current Status

✅ **EDIF Generated**: `build/tpu_basys3.edif` (1.4 MB)
⏳ **Waiting for**: Vivado to run P&R
⏳ **Next Step**: Run Vivado (see commands above)

## Quick Commands

```bash
# Check EDIF exists
ls -lh build/tpu_basys3.edif

# Run Vivado (if in PATH)
vivado -mode batch -source vivado/build_tpu_vivado.tcl

# Or use the convenience script
./scripts/build_tpu_bitstream_vivado.sh
```

## Expected Output

After Vivado completes:
- ✅ `build/tpu_top_wrapper.bit` (~2-5 MB)
- ✅ Timing reports in `vivado/tpu_basys3/`
- ✅ Utilization reports in `vivado/tpu_basys3/`

## Program FPGA

```bash
openFPGALoader -b basys3 build/tpu_top_wrapper.bit
```

