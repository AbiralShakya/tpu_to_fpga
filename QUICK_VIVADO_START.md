# Quick Start: Build TPU Bitstream with Vivado

## One-Command Build

```bash
cd /Users/abiralshakya/Documents/tpu_to_fpga
./scripts/build_tpu_bitstream_vivado.sh
```

## What You Need

1. **Yosys** ✅ (already installed)
2. **Vivado** ⚠️ (needs to be in PATH)

### Check if Vivado is Available

```bash
which vivado
vivado -version
```

### If Vivado Not Found

**On macOS** (if installed):
```bash
# Typical installation path
export PATH=/Applications/Xilinx/Vivado/2023.1/bin:$PATH
# Or wherever Vivado is installed
```

**On Linux/Cluster**:
```bash
module load vivado/2023.1
# Or your system's equivalent
```

## What Gets Generated

1. **EDIF File** (`build/tpu_basys3.edif`)
   - Generated by Yosys
   - This is the synthesized netlist
   - **This is what Vivado imports**

2. **Bitstream** (`build/tpu_top_wrapper.bit`)
   - Generated by Vivado
   - This is what you program to the FPGA

## Manual Steps (If Script Fails)

### Step 1: Generate EDIF

```bash
cd /Users/abiralshakya/Documents/tpu_to_fpga
yosys synthesis/yosys/synth_basys3_vivado.ys
```

**Check**: `ls -lh build/tpu_basys3.edif` (should exist)

### Step 2: Run Vivado

```bash
cd /Users/abiralshakya/Documents/tpu_to_fpga
vivado -mode batch -source vivado/build_tpu_vivado.tcl
```

**Check**: `ls -lh build/tpu_top_wrapper.bit` (should exist)

### Step 3: Program FPGA

```bash
openFPGALoader -b basys3 build/tpu_top_wrapper.bit
```

## Files You Need to Upload/Share

If you're working on a different machine or cluster:

**Minimum Files Needed**:
1. `build/tpu_basys3.edif` - The synthesized netlist
2. `constraints/basys3_nextpnr.xdc` - The constraints file
3. `vivado/build_tpu_vivado.tcl` - The Vivado script

**That's it!** You don't need:
- ❌ RTL source files (already in EDIF)
- ❌ Yosys scripts (already run)
- ❌ Any other files

## Quick Test

```bash
# Test EDIF generation
yosys synthesis/yosys/synth_basys3_vivado.ys
ls -lh build/tpu_basys3.edif

# If EDIF exists, you're ready for Vivado!
```

## Troubleshooting

**"Vivado not found"**:
- Install Vivado or load module
- Set PATH to Vivado bin directory

**"EDIF not found"**:
- Run Yosys synthesis first
- Check `build/` directory exists

**"Constraints not found"**:
- Check `constraints/basys3_nextpnr.xdc` exists
- Script will try `constraints/basys3.xdc` or `simple_test.xdc` as fallback

## Expected Build Time

- **Yosys**: ~30 seconds
- **Vivado P&R**: 15-35 minutes
- **Total**: ~20-40 minutes

## Success Indicators

✅ `build/tpu_basys3.edif` exists (after Yosys)
✅ `build/tpu_top_wrapper.bit` exists (after Vivado)
✅ File size: ~2-5 MB for bitstream

